// Demo: Simple Calculator with Error Handling
// Tests: result types, error codes, pick statements, functions

// Error codes
// 0 = success
// 1 = division by zero
// 2 = invalid operation

// Basic arithmetic operations with error handling
func:add = int32(int32:a, int32:b) {
    return {err:0, val:a + b};
};

func:subtract = int32(int32:a, int32:b) {
    return {err:0, val:a - b};
};

func:multiply = int32(int32:a, int32:b) {
    return {err:0, val:a * b};
};

func:divide = int32(int32:a, int32:b) {
    pick(b) {
        (0) {
            return {err:1, val:0};
        },
        (*) {
            return {err:0, val:a / b};
        }
    }
    return {err:1, val:0};
};

// Calculator that takes an operation code
// op: 1=add, 2=sub, 3=mul, 4=div
func:calculate = int32(int32:op, int32:a, int32:b) {
    pick(op) {
        (1) {
            return add(a, b);
        },
        (2) {
            return subtract(a, b);
        },
        (3) {
            return multiply(a, b);
        },
        (4) {
            return divide(a, b);
        },
        (*) {
            return {err:2, val:0};
        }
    }
    return {err:2, val:0};
};

// Test all operations
func:main = *int32() {
    print("=== Aria Calculator Demo ===");
    
    // Test addition: 10 + 5 = 15
    int32:r1 = calculate(1, 10, 5) ? -1;
    
    // Test subtraction: 20 - 8 = 12
    int32:r2 = calculate(2, 20, 8) ? -1;
    
    // Test multiplication: 6 * 7 = 42
    int32:r3 = calculate(3, 6, 7) ? -1;
    
    // Test division: 100 / 10 = 10
    int32:r4 = calculate(4, 100, 10) ? -1;
    
    // Test division by zero (should get -1 from default)
    int32:r5 = calculate(4, 10, 0) ? -1;
    
    // Test invalid operation (should get -1)
    int32:r6 = calculate(99, 5, 5) ? -1;
    
    print("All calculator tests complete!");
    return 0;
};
