// Test both calc functions
func:calc_rex = uint8(int8:w, int8:r, int8:x, int8:b) {
    uint8:rex = 0x40;
    
    if (w != 0) {
        rex |= 0x08;
    }
    if (r != 0) {
        rex |= 0x04;
    }
    if (x != 0) {
        rex |= 0x02;
    }
    if (b != 0) {
        rex |= 0x01;
    }
    
    pass(rex);
};

func:calc_modrm = uint8(int8:modval, int8:regval, int8:rmval) {
    uint8:output = 0;
    
    uint8:mod_u8 = (uint8)modval;
    uint8:reg_u8 = (uint8)regval;
    uint8:rm_u8 = (uint8)rmval;
    
    output = (mod_u8 & 0x03) << 6;
    output |= (reg_u8 & 0x07) << 3;
    output |= (rm_u8 & 0x07);
    
    pass(output);
};

func:main = int8() {
    result:r1 = calc_rex(1, 0, 0, 1);
    result:r2 = calc_modrm(3, 0, 0);
    pass(0);
};
