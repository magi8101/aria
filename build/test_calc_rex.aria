// test_calc_rex.aria
// Minimal test of REX calculation

func:calc_rex = *uint8(bool:w, int8:r_idx, int8:rm_idx) {
    bool:r = (r_idx > 7);
    bool:b = (rm_idx > 7);
    
    if (w | r | b) {
        uint8:rex = 0x40;
        if (w) { rex = rex | 0x08; }
        if (r) { rex = rex | 0x04; }
        if (b) { rex = rex | 0x01; }
        return rex;
    }
    
    return 0;
};

func:main = *int8() {
    uint8:rex = calc_rex(true, 0, 0);
    print("REX byte:");
    return 0;
};
