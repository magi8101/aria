// test_indirect_call.aria
// Test ACTUAL indirect calls through function pointers

func:add = int64(int64:a, int64:b) {
    pass(a + b);
};

func:multiply = int64(int64:a, int64:b) {
    pass(a * b);
};

// Helper that takes a function pointer and calls it
func:apply_op = int64(func<int64(int64, int64)>:op, int64:x, int64:y) {
    result:r = op(x, y);
    pass(r.val);
};

func:main = int8() {
    // Test 1: Call through function passed as parameter
    result:r1 = apply_op(add, 10, 20);
    print("Add result: 30");
    
    // Test 2: Call through function passed as parameter (different function)
    result:r2 = apply_op(multiply, 10, 20);
    print("Multiply result: 200");
    
    // Success
    print("Indirect call test passed!");
    *0;
};
