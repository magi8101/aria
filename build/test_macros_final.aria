// Control Flow Macro Test Suite (simplified, single-param functions)

%macro IF 3
if (%1 %2 %3) {
%endmacro

%macro ELSE 0
} else {
%endmacro

%macro ELIF 3
} else if (%1 %2 %3) {
%endmacro

%macro END_IF 0
}
%endmacro

%macro WHILE 3
while (%1 %2 %3) {
%endmacro

%macro END_WHILE 0
}
%endmacro

// Test 1: IF/ELSE
func:test1 = *int8(int32:x) {
    int8:ret = 0;
    IF(x, >, 10)
        ret = 1;
    ELSE
        ret = 0;
    END_IF
    return ret;
};

// Test 2: ELIF chain
func:test2 = *int8(int32:x) {
    int8:ret = 0;
    IF(x, ==, 1)
        ret = 10;
    ELIF(x, ==, 2)
        ret = 20;
    ELIF(x, ==, 3)
        ret = 30;
    ELSE
        ret = 99;
    END_IF
    return ret;
};

// Test 3: WHILE loop
func:test3 = *int32() {
    int32:sum = 0;
    int32:counter = 0;
    WHILE(counter, <, 5)
        sum = sum + counter;
        counter = counter + 1;
    END_WHILE
    return sum;
};

// Test 4: Nested IF
func:test4 = *int8(int32:x) {
    int8:ret = 0;
    IF(x, >, 10)
        IF(x, <, 50)
            ret = 1;
        END_IF
    END_IF
    return ret;
};

func:main = *int8() {
    int8:passed = 0;
    
    // Run tests
    IF(test1(15)?, ==, 1)
        passed = passed + 1;
    END_IF
    
    IF(test1(5)?, ==, 0)
        passed = passed + 1;
    END_IF
    
    IF(test2(2)?, ==, 20)
        passed = passed + 1;
    END_IF
    
    IF(test3()?, ==, 10)
        passed = passed + 1;
    END_IF
    
    IF(test4(20)?, ==, 1)
        passed = passed + 1;
    END_IF
    
    IF(test4(5)?, ==, 0)
        passed = passed + 1;
    END_IF
    
    // Return 0 if all 6 tests passed
    IF(passed, ==, 6)
        return 0;
    ELSE
        return 1;
    END_IF
};
