// ============================================================================
// Test Suite: Standard Library Math Functions
// ============================================================================
// Tests macro-generated math functions across all numeric types
// ============================================================================

// Note: We'll include the stdlib once it's in a known location
// For now, test with inline macro generation

%macro GEN_ABS 1
func:abs_%1 = *%1(%1:value) {
    if (value < 0) {
        return 0 - value;
    }
    return value;
};
%endmacro

%macro GEN_MIN 1
func:min_%1 = *%1(%1:a, %1:b) {
    if (a < b) {
        return a;
    }
    return b;
};
%endmacro

%macro GEN_MAX 1
func:max_%1 = *%1(%1:a, %1:b) {
    if (a > b) {
        return a;
    }
    return b;
};
%endmacro

// Generate for int32 (our test type)
GEN_ABS(int32)
GEN_MIN(int32)
GEN_MAX(int32)

// Test functions
func:test_abs = *int8() {
    int32:r1 = abs_int32(5) ? 0;
    int32:r2 = abs_int32(0 - 5) ? 0;
    int32:r3 = abs_int32(0) ? 0;
    
    if (r1 == 5) {
        if (r2 == 5) {
            if (r3 == 0) {
                return 1;
            }
        }
    }
    return 0;
};

func:test_min = *int8() {
    int32:r1 = min_int32(5, 10) ? 0;
    int32:r2 = min_int32(10, 5) ? 0;
    int32:r3 = min_int32(7, 7) ? 0;
    
    if (r1 == 5) {
        if (r2 == 5) {
            if (r3 == 7) {
                return 1;
            }
        }
    }
    return 0;
};

func:test_max = *int8() {
    int32:r1 = max_int32(5, 10) ? 0;
    int32:r2 = max_int32(10, 5) ? 0;
    int32:r3 = max_int32(7, 7) ? 0;
    
    if (r1 == 10) {
        if (r2 == 10) {
            if (r3 == 7) {
                return 1;
            }
        }
    }
    return 0;
};

func:main = *int8() {
    int8:tests_passed = 0;
    
    if (test_abs() ? 0 == 1) {
        tests_passed = tests_passed + 1;
    }
    
    if (test_min() ? 0 == 1) {
        tests_passed = tests_passed + 1;
    }
    
    if (test_max() ? 0 == 1) {
        tests_passed = tests_passed + 1;
    }
    
    if (tests_passed == 3) {
        return 0;
    }
    return 1;
};
