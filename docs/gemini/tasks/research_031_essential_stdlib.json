{
    "task_id": "research_031_essential_stdlib",
    "title": "Essential Standard Library (Compiler Bootstrap Requirements)",
    "priority": "critical",
    "category": "standard_library",
    "dependencies": [
        "research_005_io_library",
        "research_022_wild_wildx_memory"
    ],
    "estimated_complexity": "very_high",
    "description": "Specification for the minimal standard library required to bootstrap the Aria compiler and write basic programs. Covers platform syscalls, memory allocation, string manipulation, formatted output, file I/O, and essential math functions.",
    "scope": {
        "platform_syscalls": "Platform-specific system calls (Linux, Windows, macOS)",
        "memory_functions": "aria.alloc, aria.free, aria.realloc, memcpy, memset",
        "string_library": "String manipulation, comparison, searching, UTF-8 operations",
        "formatted_io": "print, printf-style formatting, string interpolation backend",
        "file_io": "readFile, writeFile, openFile with platform abstraction",
        "math_library": "Essential math operations (sqrt, sin, cos, pow, abs, etc.)",
        "error_handling": "Platform error code translation to Aria result types"
    },
    "key_questions": {
        "platform_syscalls": [
            "What syscalls are absolutely required (read, write, open, close, mmap)?",
            "How to abstract platform differences (Linux vs Windows vs macOS)?",
            "What syscall wrapper design (inline asm vs C runtime)?",
            "How to handle syscall errors (errno translation to TBB ERR)?",
            "What platform detection at compile-time (cfg macros)?",
            "Which syscalls for memory management (mmap, VirtualAlloc, vm_allocate)?",
            "Which syscalls for file I/O (open/read/write vs CreateFile/ReadFile)?",
            "Which syscalls for process management (fork, exec, spawn)?",
            "How to handle platform-specific types (file descriptors, handles)?"
        ],
        "memory_functions": [
            "What is the complete aria.alloc API signature?",
            "How does aria.alloc integrate with Mimalloc backend?",
            "What alignment control exists (aria.alloc_aligned)?",
            "How does aria.realloc preserve data during resize?",
            "What aria.free semantics (immediate vs deferred)?",
            "How to implement memcpy, memset, memmove efficiently?",
            "What SIMD optimizations for bulk memory operations?",
            "How to detect memory leaks in wild allocations?",
            "What arena allocation helpers (aria.arena.new, aria.arena.reset)?"
        ],
        "string_library": [
            "What string types (string for GC, wild string for manual)?",
            "How to implement strlen, strcmp, strcpy for UTF-8?",
            "What string searching (indexOf, lastIndexOf, contains)?",
            "How to handle string concatenation (+ operator backend)?",
            "What string slicing operations (substring, split)?",
            "How to implement case conversion (toUpper, toLower) for UTF-8?",
            "What string trimming (trim, trimStart, trimEnd)?",
            "How to implement string interpolation for template literals?",
            "What UTF-8 validation and character iteration?"
        ],
        "formatted_io": [
            "What is the print() implementation (stdout.write wrapper)?",
            "How to implement printf-style formatting ('%d', '%s', '%x')?",
            "What format specifiers are needed (int, flt, string, hex, binary)?",
            "How does template literal interpolation work (&{expr} evaluation)?",
            "What buffering strategy for stdout/stderr?",
            "How to format TBB types (display ERR sentinel)?",
            "What number formatting (decimal places, padding, alignment)?",
            "How to handle format errors (invalid specifiers)?"
        ],
        "file_io": [
            "What is the readFile() signature and implementation?",
            "What is the writeFile() signature and implementation?",
            "How to abstract file operations (FD on Unix, HANDLE on Windows)?",
            "What error handling (file not found, permission denied)?",
            "How to implement openFile, closeFile for streaming?",
            "What buffering strategy for file reads/writes?",
            "How to handle large files (streaming vs load entire)?",
            "What path manipulation (join, normalize, relative)?",
            "How to check file existence, get file size, stat info?"
        ],
        "math_library": [
            "What essential math functions (sqrt, pow, abs, min, max)?",
            "What trigonometry (sin, cos, tan, asin, acos, atan, atan2)?",
            "What logarithms (log, log2, log10, exp)?",
            "What rounding (floor, ceil, round, trunc)?",
            "What constants (PI, E, INFINITY, NAN)?",
            "How to implement math for TBB types (overflow → ERR)?",
            "What SIMD vectorization for math operations?",
            "How to handle special values (NaN, Infinity) in floats?",
            "What random number generation (rand, random_range)?"
        ],
        "error_handling": [
            "How to translate platform errors to result types?",
            "What errno/GetLastError mapping to Aria error strings?",
            "How to create structured error objects?",
            "What error message formatting?",
            "How to integrate platform errors with TBB ERR sentinels?"
        ],
        "bootstrap_dependencies": [
            "What minimal subset needed for 'hello world'?",
            "What is required for basic file I/O programs?",
            "What is needed to implement the compiler in Aria (self-hosting)?",
            "What testing utilities are needed?",
            "Can we bootstrap without full GC (wild-only initially)?"
        ]
    },
    "deliverables": [
        "Essential stdlib specification (1000-1200 lines)",
        "Platform syscall abstraction layer design",
        "Memory allocation API complete reference",
        "String library with UTF-8 support",
        "Printf-style formatting specification",
        "File I/O API with platform abstraction",
        "Math library function reference",
        "Error translation tables (errno → Aria errors)",
        "Bootstrap roadmap (minimal → full stdlib)",
        "Implementation priority ordering",
        "Platform compatibility matrix (Linux, Windows, macOS)",
        "Code examples for each subsystem",
        "Performance requirements",
        "Testing strategy"
    ],
    "context_files": [
        "/docs/info/aria_specs.txt (stdlib function list)",
        "/docs/gemini/responses/research_005_io_library.txt (I/O integration)",
        "/docs/gemini/responses/research_022_wild_wildx_memory.txt (allocation API)",
        "/src/runtime/ (existing runtime stubs)"
    ],
    "notes": "This is the ABSOLUTE MINIMUM required to write and test basic Aria programs. Advanced features like HTTP, JSON parsing, crypto, etc. can come later. Focus on what's needed to bootstrap the compiler itself and write simple command-line tools."
}